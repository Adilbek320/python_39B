var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},__assign.apply(this,arguments)},__read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},__spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};!function(){function e(e){var t;void 0===e&&(e=!1);var n=["SVG","SCRIPT","STYLE","NOSCRIPT"],r=[],o=document.body,i=null===(t=null===s||void 0===s?void 0:s.LIVE_TRANSLATIONS)||void 0===t?void 0:t.noTranslates,a=i&&i.length&&i.join(","),u=!0;if(a)try{o.querySelector(a)}catch(e){u=!1,console.warn("Error::","filter exceptions",e)}var l=function(e){return e[m.PARSED]=!0},c=function(e){return e[m.PARSED]=!1},d=function(e){return!!e[m.PARSED]},g=function(t){return function(n){return!!n[m.FORCED]||(e?t(n):!t(n))}}(d),p=[function(e){var t="INPUT"===e.tagName;if(t){var n=e.getAttribute("type");if(n){n=n.toLowerCase();var r=e.getAttributeNode("value"),o="button"===n,i="reset"===n,a="submit"===n;return t&&(o||i||a)&&r}}}],y=O(h,p),_=function(e){if(e.className&&-1!==e.className.indexOf("uwy")&&"application"===e.getAttribute("role"))return!0;if(e.getAttribute("data-uw-ignore-translate"))return!0;var t=e.tagName&&e.tagName.toUpperCase();return"TEXTAREA"===t||"CODE"===t||"PRE"===t||!!e.getAttribute("contenteditable")};P(o)&&g(o)&&!_(o)&&r.push(o),y(o).forEach(function(e){g(e)&&(l(e),r.push(e))});var T=function(e){e.hasChildNodes()&&!_(e)&&Array.from(e.childNodes).forEach(function(e){var t;if(!u||!C(a,e)){var o=e.tagName&&e.tagName.toUpperCase();if((!o||-1===n.indexOf(o))&&(w[E]&&(Object.values(w[E]).includes(null===(t=e.nodeValue)||void 0===t?void 0:t.trim())||c(e)),e.nodeType===Node.TEXT_NODE&&g(e)&&P(e)&&(l(e),(e.nodeValue.startsWith(" ")||e.nodeValue.startsWith(" "))&&(e[f]=e.nodeValue[0]),(e.nodeValue.endsWith(" ")||e.nodeValue.endsWith(" "))&&(e[v]=e.nodeValue.slice(-1)),r.push(e)),e.nodeType===Node.ELEMENT_NODE))if("IFRAME"===o){var i=e,s=i.baseURI.includes(document.location.origin);if(s)try{var d=i.contentDocument||i.contentWindow.document;T(d.body)}catch(e){console.log("Error::","parse embed iframe",e)}}else y(e).forEach(function(e){g(e)&&(l(e),r.push(e))}),T(e)}})};return T(o),r}function t(e,t){return u.request({method:"POST",url:d+"/remediation/translate",header:{"Content-Type":"application/json"},body:{translateAccCode:UserWayWidgetApp.ContextHolder.config.account,translateSiteId:UserWayWidgetApp.ContextHolder.config.services.siteId,translatePageUrl:window.location.href,translateSentences:e,translateToLanguage:t}}).then(function(e){try{return JSON.parse(null===e||void 0===e?void 0:e.response)}catch(e){return console.error(i,e),null}}).then(function(e){return(null===e||void 0===e?void 0:e.code)&&200!==(null===e||void 0===e?void 0:e.code)?(console.error(i,null===e||void 0===e?void 0:e.message),null):e})}function n(e){var t=e.resolve,n=e.reject,r=e.items;if(!r.length)return t();if(!E)return n(i+": No language specified!");try{R(r,E).then(function(){return I(r)}).catch(function(e){return n(e)})}catch(e){console.log("Error::",i,e),n(e)}t()}function r(e){return b()?e.filter(function(e){return!A(e)}):e}function o(t){var n=e(!0);return Promise.all(n.map(function(e){var n=N(e.nodeValue,t,e);return n?U(e,n).then(function(){delete e[m.PARSED]}):(console.log("Can't revert translation for the node: ",e),Promise.resolve())}))}var i="LIVE_TRANSLATIONS",a=UserWayWidgetApp.addLib(i),u=UserWayWidgetApp.getLib("util"),s=UserWayWidgetApp.ContextHolder.config.services,l=window.UserWayWidgetApp.getLib("dom_observer"),c=window.UserWayWidgetApp.getLib("event_emitter"),d="https://api.userway.org/api",f="string_start_space_value",v="string_end_space_value",g=["en","en-us","en-au","en-gb"],p=l.DOM_OBSERVER_DOM_CHANGED_EVENT,m={PARSED:"prs",FORCED:"uw_forced_translate"},h=function(){return 254989===(null!==s&&void 0!==s?s:s.userId)?["title","alt","placeholder"]:["aria-label","title","alt","placeholder"]}(),y=["$"],E=null,w={},_=!1,T=null,b=function(){return!!w[E]},A=function(e){return w[E][e]},N=function(e,t,n){e=u.customTrim(e);var r=w[t],o=Object.keys(r).find(function(t){return u.customTrim(r[t])===e});return r?n[f]||n[v]?V(n,o):o:null},S=function(e){return w[E]=__assign(__assign({},w[E]),e)},L=function(){if(_){var t=e();a.doRemediation(null,t)}};a.getCurrentLanguage=function(){return E},a.enable=function(){_=!0,c.on(p,L)},a.disable=function(){_=!1,c.off(p,L)},a.isEnabled=function(){return _},a.awaitForResources=function(){var e=window.localStorage.getItem("userway-selectedSiteLang"),t=s.LIVE_TRANSLATIONS&&s.LIVE_TRANSLATIONS.autoTranslation&&e;return t?(E=e,a.translateSite().then(function(){return t})):(window.localStorage.removeItem("userway-selectedSiteLang"),Promise.resolve(t))},a.doRemediation=function(e,t){return new Promise(function(e,r){n({items:t,resolve:e,reject:r})})},a.translateSite=function(t){if(void 0===t&&(t=E),!UserWayWidgetApp.ContextHolder.config.partner===atob("cmFrYmFuaw==")){var n=new CustomEvent("userway:translate",{detail:{locale:t},bubbles:!1,cancelable:!0});if(!document.dispatchEvent(n))return Promise.resolve()}if(!t)return console.error(i,"No translation language specified!"),Promise.resolve();if(T===t)return Promise.resolve();if(T&&g.includes(T.toLowerCase())&&g.includes(t.toLowerCase()))return Promise.resolve();var r=e();return E=t,document.querySelector("html").setAttribute("lang",E),R(r,t).then(function(){return I(r)}).then(function(){return a.enable()}).catch(function(e){return console.log("Error::",i,e)})},a.revertToOriginal=function(){if(!a.isEnabled())return Promise.resolve();a.disable();var e=E;return E=null,o(e)};var C=function(e,t){var n,r;if(!e||!t)return!1;var o=t.nodeType===Node.ELEMENT_NODE,i=t.nodeType===Node.TEXT_NODE,a=t.nodeType===Node.ATTRIBUTE_NODE;return!(!o||!t.matches(e))||!!(i&&(null===(n=t.parentElement)||void 0===n?void 0:n.closest(e))||a&&(null===(r=t.ownerElement)||void 0===r?void 0:r.closest(e)))},O=function(e,t){return void 0===t&&(t=[]),function(n){return n?e.map(function(e){return n.getAttributeNode(e)}).concat(t.map(function(e){return e(n)})).filter(Boolean):[]}},P=function(e){if(!e)return!1;var t=e.nodeType,n=e.nodeValue;return t===Node.TEXT_NODE&&n.length>0&&-1===n.search(/^\s+$/i)},R=function(e,n){var o=new Set;e.forEach(function(e){var t=u.customTrim(e.nodeValue);o.add(t)});var a=r(__spreadArray([],__read(o),!1));if(!a.length)return Promise.resolve();var s={"pt-BR":"pt","es-MX":"es","en-US":"en","en-AU":"en","en-GB":"en",prs:"fa"};return s[n]&&(n=s[n]),t(a.filter(function(e){return""!==e}),n).then(function(e){if(!e)throw new Error(i+": No translation data.");S(e.data.translations)})},W=function(e,t){return e[0].toUpperCase()===e[0]?t[0].toUpperCase()+t.slice(1):t[0].toLowerCase()+t.slice(1)},I=function(e,t){var n;void 0===t&&(t="");var r=null===(n=null===s||void 0===s?void 0:s.LIVE_TRANSLATIONS)||void 0===n?void 0:n.overrides;return Promise.all(e.map(function(e){var t=u.customTrim(e.nodeValue);if(y.includes(t))return Promise.resolve();var n;if(r["*"]||r[E]){var o=function(e){var t;return null!==(t=r[e])&&void 0!==t?t:[]};__spreadArray(__spreadArray([],__read(o("*")),!1),__read(o(E)),!1).map(function(r){var o;if(!n){var i=new RegExp(r.source,"ig");if(null===(o=r.selectors)||void 0===o?void 0:o.length)r.selectors.map(function(o){var a,u;n||((null===(a=e.parentElement)||void 0===a?void 0:a.matches(o))||(null===(u=e.ownerElement)||void 0===u?void 0:u.matches(o)))&&(n=e[f]||e[v]?V(e,A(t)):A(t),n.toLowerCase().includes(r.correction.toLowerCase())||(n=n.replace(i,function(e){return W(e,r.correction)})))});else{var a=e[f]||e[v]?V(e,A(t)):A(t);a&&a.toLowerCase().includes(r.source.toLowerCase())&&!a.toLowerCase().includes(r.correction.toLowerCase())&&(n=a.replace(i,function(e){return W(e,r.correction)}))}}})}return n?w[E][t]=u.customTrim(n):n=e[f]||e[v]?V(e,A(t)):A(t),n?U(e,n):(console.log("Node ",e," is not translated."),Promise.resolve())}))},V=function(e,t){return t?(e[v]&&e[f]?t=e[f]+t+e[v]:e[f]?t=e[f]+t:t+=e[v],t):null},U=function(e,t){return new Promise(function(n){var r=e.parentElement;if(e.nodeValue===t)return n();if(!r)return e.nodeValue=t,n();var o=r.style.backgroundColor,i=r.style.transition;setTimeout(function(){r.style.backgroundColor="rgba(255,241,141,0.9)",r.style.transition="background-color 0.3s",e.nodeValue=t,setTimeout(function(){r.style.backgroundColor=o,setTimeout(function(){r.style.transition=i,n()},300)},300)})})},D=function(){u.postMessage({action:"websiteTranslationCompleted"}),window.postMessage({isUserWay:!0,action:"websiteTranslationCompleted"},"*")},x=function(){window.postMessage({isUserWay:!0,action:"websiteTranslationReverted"},"*")},M=function(e){window.localStorage.setItem("userway-selectedSiteLang",e),document.documentElement.setAttribute("lang",e)},j=function(){var e=UserWayWidgetApp.ContextHolder.config.widgetPageLang;document.documentElement.setAttribute("lang",e),window.localStorage.removeItem("userway-selectedSiteLang")};!function(){var e=document.querySelector("html");T=e.getAttribute("lang")||"en-us";var t=function(e){var t=e.data,n=t.action,r=t.value,o=t.shouldNotTriggerLiveTranslation,i=void 0!==o&&o;switch(n){case"setWidgetLanguage":case"disableLiveTranslation":if(i)break;a.revertToOriginal().then(function(){return j()}).then(function(){return x()});break;case"translateWebsite":a.revertToOriginal().then(function(){return M(r)}).then(function(){return a.translateSite(r)}).then(function(){return D()})}};u.registerPostMessageListener(t)}()}();